<ng-container *ngIf="place$ | async as place; else loading">
  <div class="min-h-screen bg-gray-50 pb-12">

    <!-- BARRE ACTIONS ADMIN EN HAUT -->
    <div class="max-w-6xl mx-auto px-4 pt-6 flex justify-end" *ngIf="isAdmin">
      <app-place-admin-actions
        [place]="place"
        [isAdmin]="isAdmin"
        (edit)="openEditModal($event)"
        (delete)="onDeletePlace($event)">
      </app-place-admin-actions>
    </div>

    <!-- HEADER / HERO -->
    <app-place-header
      [place]="place"
      [averageRating]="averageRating"
      [commentsCount]="comments.length">
    </app-place-header>

    <div class="max-w-6xl mx-auto px-4 mt-6 grid grid-cols-1 lg:grid-cols-3 gap-6">

      <!-- COLONNE PRINCIPALE -->
      <div class="space-y-6 lg:col-span-2">
        <app-place-media-gallery
          [place]="place"
          [uploadingImages]="uploadingImages"
          [uploadingVideos]="uploadingVideos"
          [uploadError]="uploadError"
          [editMode]="showEditModal"
          (addImages)="onUploadImages($event)"
          (addVideos)="onUploadVideos($event)">
        </app-place-media-gallery>

        <app-place-info
          [place]="place">
        </app-place-info>

        <app-place-comments
          [comments]="comments"
          [isLoggedIn]="isLoggedIn"
          [currentUserName]="currentUserName"
          [isSubmitting]="isSubmittingComment"
          (submitComment)="onSubmitComment($event)">
        </app-place-comments>
      </div>

      <!-- COLONNE LATÃ‰RALE -->
      <div class="space-y-6">
        <app-place-map-card
          [mapOptions]="mapOptions"
          [mapLayers]="mapLayers">
        </app-place-map-card>
      </div>
    </div>

    <app-place-edit-modal
      *ngIf="showEditModal"
      [place]="editingPlace"
      [categories]="availableCategories"
      [isSaving]="isSavingPlace"
      [uploadError]="uploadError"
      (cancel)="closeEditModal()"
      (save)="onSaveEditedPlace($event)">
    </app-place-edit-modal>
  </div>
</ng-container>

<ng-template #loading>
  <div class="min-h-screen flex items-center justify-center text-gray-500">
    Chargement du lieu...
  </div>
</ng-template>
